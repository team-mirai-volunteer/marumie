# 新規参加者向けSupabaseセットアップガイド

## 前提条件

- Docker Desktopがインストール済み
- Node.js (18以上) がインストール済み
- プロジェクトをクローン済み

## 簡単セットアップ（推奨）

### 1. 依存関係インストール

```bash
npm install
```

### 2. Supabaseローカル環境セットアップ（自動）

```bash
npm run supabase:setup:local
```

**このコマンドが以下を自動実行します：**
- Docker確認
- Supabaseエミュレーター起動
- データベースリセット
- マイグレーション適用
- 型定義生成

**完了すると以下が表示されます：**

```
📊 Supabase Studio: http://127.0.0.1:54323
🔌 API URL: http://127.0.0.1:54321
🗄️  DB URL: postgresql://postgres:postgres@127.0.0.1:54332/postgres
```

### 3. 確認

```bash
# テーブル作成確認
npm run supabase:check
```

以下のようなテーブル一覧が表示されればOK：
```
                  List of relations
 Schema |          Name           | Type  |  Owner
--------+-------------------------+-------+----------
 public | political_organizations | table | postgres
 public | transactions            | table | postgres
```

## 手動セットアップ（トラブル時）

自動セットアップでエラーが発生した場合は、以下の手順で手動セットアップしてください。

### 1. Docker Desktop起動確認

```bash
# Docker が起動しているか確認
docker --version
docker ps
```

### 2. Supabaseローカル環境起動

```bash
# Supabaseエミュレーター起動
npx supabase start
```

### 3. マイグレーション適用

```bash
# データベースリセット
npx supabase db reset

# マイグレーション手動適用
cat supabase/migrations/*.sql | docker exec -i supabase_db_poli-money-something psql -U postgres -d postgres
```

### 4. 型定義生成

```bash
# TypeScript型定義ファイル生成
npm run supabase:types
```
