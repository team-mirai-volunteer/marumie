# 政治団体ページのセクション分割設計

## 概要

現在の `webapp/src/app/[slug]/page.tsx` では、MainColumn内に複数のセクションがベタ書きで実装されている。これを各セクションを独立したコンポーネントに分割し、保守性と再利用性を向上させる。

## 現在の構造

```
MainColumn
├── MainColumnCard (セクション1: チームみらいの収支の流れ)
├── MainColumnCard (セクション2: 1年間の収支の推移)  
├── MainColumnCard (セクション3: これまでの累計寄付金額)
├── MainColumnCard (セクション4: すべての出入金)
└── MainColumnCard (セクション5: 説明セクション)
```

## 提案する新しい構造

```
MainColumn
├── CashFlowSection (収支の流れセクション)
├── MonthlyTrendsSection (月次推移セクション)
├── DonationSummarySection (寄付金額セクション)
├── TransactionsSection (出入金セクション)
└── ExplanationSection (説明セクション)
```

## 各コンポーネントの設計

### 1. CashFlowSection (収支の流れセクション)

**ファイル名:** `webapp/src/client/components/features/political-organization/CashFlowSection.tsx`

**props:**
```typescript
interface CashFlowSectionProps {
  sankeyData: SankeyData | null;
}
```

**責任:**
- サンキー図の表示
- 財務サマリーの表示
- CardHeaderの管理

### 2. MonthlyTrendsSection (月次推移セクション)

**ファイル名:** `webapp/src/client/components/features/political-organization/MonthlyTrendsSection.tsx`

**props:**
```typescript
interface MonthlyTrendsSectionProps {
  // 将来的に月次データを追加
}
```

**責任:**
- 月次収支推移グラフの表示（現在はプレースホルダー）
- CardHeaderの管理

### 3. DonationSummarySection (寄付金額セクション)

**ファイル名:** `webapp/src/client/components/features/political-organization/DonationSummarySection.tsx`

**props:**
```typescript
interface DonationSummarySectionProps {
  // 将来的に寄付統計データを追加
}
```

**責任:**
- 累計寄付金額の表示
- 寄付統計サマリーカードの管理
- 寄付推移グラフの表示（現在はプレースホルダー）
- 寄付メッセージとボタンの表示
- CardHeaderの管理

### 4. TransactionsSection (出入金セクション)

**ファイル名:** `webapp/src/client/components/features/politician/TransactionsSection.tsx`

**props:**
```typescript
interface TransactionsSectionProps {
  transactionData: TransactionData | null;
  slug: string;
}
```

**責任:**
- トランザクションテーブルの表示
- 「もっと見る」ボタンの管理
- CardHeaderの管理

### 5. ExplanationSection (説明セクション)

**ファイル名:** `webapp/src/client/components/features/politician/ExplanationSection.tsx`

**props:**
```typescript
interface ExplanationSectionProps {
  // propsなし（静的コンテンツ）
}
```

**責任:**
- Mirai Open Dataについての説明
- データソースの説明
- 免責事項の表示

## ディレクトリ構造

```
webapp/src/client/components/features/political-organization/
├── CashFlowSection.tsx
├── MonthlyTrendsSection.tsx  
├── DonationSummarySection.tsx
├── TransactionsSection.tsx
└── ExplanationSection.tsx
```

## リファクタリング後のpage.tsx

```typescript
import "server-only";
import MainColumn from "@/client/components/layout/MainColumn";
import CashFlowSection from "@/client/components/features/political-organization/CashFlowSection";
import MonthlyTrendsSection from "@/client/components/features/political-organization/MonthlyTrendsSection";
import DonationSummarySection from "@/client/components/features/political-organization/DonationSummarySection";
import TransactionsSection from "@/client/components/features/political-organization/TransactionsSection";
import ExplanationSection from "@/client/components/features/political-organization/ExplanationSection";

export default async function PoliticianPage({ params }) {
  const { slug } = await params;
  
  const sankeyData = await getSankeyData({ slug });
  const transactionData = await getTransactionsBySlugAction({
    slug,
    page: 1,
    perPage: 7,
  }).catch(() => null);

  return (
    <MainColumn>
      <CashFlowSection sankeyData={sankeyData} />
      <MonthlyTrendsSection />
      <DonationSummarySection />
      <TransactionsSection transactionData={transactionData} slug={slug} />
      <ExplanationSection />
    </MainColumn>
  );
}
```

## 実装方針

1. **段階的移行**: 一度にすべてのセクションをコンポーネント化せず、1つずつ移行
2. **共通パターンの抽出**: 各セクションで共通するCardHeaderパターンを抽出
3. **型安全性**: 各コンポーネントのpropsを適切に型定義
4. **テスト可能性**: 各セクションが独立してテスト可能な設計

## 期待される効果

- **保守性向上**: 各セクションの変更が他に影響しない
- **再利用性向上**: 他のページでも同様のセクションを再利用可能
- **テスト容易性**: セクション単位でのテストが可能
- **コード可読性向上**: page.tsxがよりシンプルで理解しやすくなる